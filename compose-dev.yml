version: '3.1'

# This setup is for dev only. It spins up the app in its own container along
# with a temporary postgres db container. In production, the db would use a
# 3rd party service (e.g., RDS) and the app would be loaded into a higher-order
# deployment (e.g., docker swarm) which would load other services as well.
services:
  api:
    build: .
    ports:
      - 3000:3000
    volumes:
      - ./server:/opt/app/server
      - ./build:/srv/app
    depends_on:
      - db

  db:
    image: postgres:9.5.6
    ports:
      - 54322:5432
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_DB=robmclarty-dev
      - POSTGRES_PASSWORD=dbpass
      - DATABASE=postgres://postgres:dbpass@localhost:54322/robmclarty-dev
